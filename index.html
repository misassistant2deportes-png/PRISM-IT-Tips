<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<title>IT Troubleshooting Tips</title>
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
	<style>
		:root{
			--bg-1:#eef2ff;
			--bg-2:#f8fafc;
			--card:#ffffff;
			--accent:#2563eb;
			--accent-2:#06b6d4;
			--muted:#6b7280;
			--text:#0f172a;
			--glass: rgba(255,255,255,0.7);
		}

		:root.dark-mode{
			--bg-1:#0f172a;
			--bg-2:#1e293b;
			--card:#1e293b;
			--accent:#3b82f6;
			--accent-2:#06b6d4;
			--muted:#a1a5b4;
			--text:#e2e8f0;
			--glass: rgba(30,41,59,0.7);
		}

		*{box-sizing:border-box}
		body{font-family:Inter,Segoe UI,Arial,sans-serif;margin:0;background:linear-gradient(180deg,var(--bg-1),var(--bg-2));color:var(--text);min-height:100vh;transition:background-color .3s ease,color .3s ease}
		.wrap{max-width:1100px;margin:40px auto;padding:28px}

		header{display:flex;align-items:center;justify-content:space-between;gap:18px}
		.brand{display:flex;flex-direction:column}
		h1{margin:0;font-size:1.4rem;font-weight:700;letter-spacing:-0.2px}
		p.lead{margin:6px 0 0;color:var(--muted);font-size:0.95rem}

		.theme-toggle{background:linear-gradient(135deg,#fbbf24,#f97316);border:none;padding:10px 14px;border-radius:10px;cursor:pointer;font-size:1.3rem;display:flex;align-items:center;justify-content:center;width:44px;height:44px;transition:all .2s ease;box-shadow:0 4px 12px rgba(37,99,235,0.2);font-weight:600}
		.theme-toggle:hover{transform:scale(1.08);box-shadow:0 6px 16px rgba(37,99,235,0.3)}
		.theme-toggle:active{transform:scale(0.95)}
		:root.dark-mode .theme-toggle{background:linear-gradient(135deg,#3b82f6,#2563eb);box-shadow:0 4px 12px rgba(59,130,246,0.3)}

		.controls{display:flex;gap:14px;flex-wrap:wrap;margin:18px 0;align-items:center}
		.search{flex:1;min-width:220px;position:relative}
		.search input{width:100%;padding:12px 14px 12px 40px;border-radius:12px;border:1px solid rgba(15,23,42,0.06);background:var(--glass);backdrop-filter:blur(6px);color:var(--text)}
		.search input::placeholder{color:var(--muted)}
		:root.dark-mode .search input{border-color:rgba(226,232,240,0.06)}
		.search svg{position:absolute;left:12px;top:50%;transform:translateY(-50%);opacity:0.6}

		.categories{display:flex;gap:8px;flex-wrap:wrap}
		.cat{background:transparent;border:1px solid transparent;padding:8px 12px;border-radius:999px;cursor:pointer;color:var(--muted);font-weight:600;transition:all .2s ease}
		.cat.active{background:linear-gradient(90deg,var(--accent),var(--accent-2));color:#fff;border-color:transparent;box-shadow:0 6px 18px rgba(37,99,235,0.12)}

		#addTipBtn{background:linear-gradient(90deg,#10b981,#06b6d4);color:#fff;border:0;padding:10px 14px;border-radius:10px;cursor:pointer;box-shadow:0 8px 20px rgba(6,182,212,0.12);font-weight:600}

		.list{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:16px;margin-top:18px}
		.tip{background:var(--card);padding:16px;border-radius:12px;border:1px solid rgba(15,23,42,0.04);box-shadow:0 6px 18px rgba(2,6,23,0.06);transition:transform .18s ease,box-shadow .18s ease;cursor:pointer}
		:root.dark-mode .tip{border-color:rgba(226,232,240,0.04);box-shadow:0 6px 18px rgba(0,0,0,0.3)}
		.tip:hover{transform:translateY(-6px);box-shadow:0 14px 30px rgba(2,6,23,0.08)}
		:root.dark-mode .tip:hover{box-shadow:0 14px 30px rgba(0,0,0,0.4)}
		.tip h3{margin:0 0 6px;font-size:1.02rem}
		.tags{display:inline-block;font-size:0.82rem;color:var(--muted);margin-bottom:8px;padding:6px 8px;border-radius:8px;background:linear-gradient(180deg,rgba(15,23,42,0.02),transparent)}
		:root.dark-mode .tags{background:linear-gradient(180deg,rgba(226,232,240,0.05),transparent)}
		.steps{font-size:0.95rem;color:var(--text);line-height:1.45}
		button.copy{margin-top:12px;background:var(--accent);color:#fff;border:0;padding:8px 12px;border-radius:8px;cursor:pointer;font-weight:600;transition:opacity .2s ease}
		button.copy:hover{opacity:0.9}

		footer{margin-top:28px;color:var(--muted);font-size:0.92rem}

		/* Modal tweaks */
		#modal{display:none;position:fixed;inset:0;background:linear-gradient(rgba(2,6,23,0.45),rgba(2,6,23,0.45));align-items:center;justify-content:center;padding:20px}
		:root.dark-mode #modal{background:linear-gradient(rgba(0,0,0,0.7),rgba(0,0,0,0.7))}
		#tipForm{background:linear-gradient(180deg,#ffffff,#fbfdff);border-radius:12px;padding:18px;max-width:720px;width:100%;box-shadow:0 18px 40px rgba(2,6,23,0.12)}
		:root.dark-mode #tipForm{background:linear-gradient(180deg,#1e293b,#0f172a)}
		#tipForm input,#tipForm select,#tipForm textarea{border-radius:8px;border:1px solid rgba(15,23,42,0.06);padding:10px;background:var(--card);color:var(--text)}
		:root.dark-mode #tipForm input,:root.dark-mode #tipForm select,:root.dark-mode #tipForm textarea{border-color:rgba(226,232,240,0.06)}
		.form-actions{display:flex;gap:10px;justify-content:flex-end;margin-top:12px}
		.btn-ghost{background:#fff;border:1px solid rgba(15,23,42,0.06);padding:8px 12px;border-radius:8px;cursor:pointer;color:var(--text)}
		:root.dark-mode .btn-ghost{background:#0f172a;border-color:rgba(226,232,240,0.06)}
		.btn-primary{background:var(--accent);color:#fff;border:0;padding:8px 12px;border-radius:8px;cursor:pointer}

		#viewModal{display:none;position:fixed;inset:0;background:rgba(2,6,23,0.5);align-items:center;justify-content:center;padding:20px;z-index:100}
		:root.dark-mode #viewModal{background:rgba(0,0,0,0.7)}
		#viewModal > div{background:var(--card);border-radius:12px;padding:24px;max-width:600px;width:100%;box-shadow:0 12px 36px rgba(2,6,23,0.15);position:relative;max-height:80vh;overflow-y:auto}
		:root.dark-mode #viewModal > div{box-shadow:0 12px 36px rgba(0,0,0,0.5)}

		@media (max-width:520px){.wrap{padding:16px}.list{gap:12px}}
	</style>
</head>
<body>
	<div class="wrap">
		<header>
			<div>
				<h1>IT Troubleshooting Tips</h1>
				<p class="lead">Quick, searchable solutions your team can use and share.</p>
			</div>
			<button class="theme-toggle" id="themeToggle" aria-label="Toggle dark mode">ðŸŒ™</button>
		</header>
		<div style="margin-top:12px;display:flex;justify-content:space-between;gap:12px;align-items:center">
			<div style="flex:1"></div>
			<div>
				<button id="addTipBtn" style="background:#10b981;color:#fff;border:0;padding:9px 12px;border-radius:8px;cursor:pointer">+ Add Tip</button>
			</div>
		</div>

		<div class="controls">
			<div class="search">
				<input id="q" type="text" placeholder="Search titles, descriptions, or steps..." aria-label="Search tips">
			</div>
			<div class="categories" role="tablist" aria-label="Categories">
				<button class="cat active" data-cat="all">All</button>
				<button class="cat" data-cat="network">Network</button>
				<button class="cat" data-cat="software">Software</button>
				<button class="cat" data-cat="hardware">Hardware</button>
				<button class="cat" data-cat="accounts">Accounts</button>
			</div>
		</div>

		<div class="list" id="tips">
			<article class="tip" data-cat="network" data-title="Can't connect to Wiâ€‘Fi">
				<h3>Can't connect to Wiâ€‘Fi</h3>
				<div class="tags">Category: Network</div>
				<div class="steps">
					1. Confirm Wiâ€‘Fi is enabled on the device.<br>
					2. Forget the SSID and reconnect with correct password.<br>
					3. Reboot the router if multiple devices affected.
				</div>
				<button class="copy">Copy steps</button>
			</article>

			<article class="tip" data-cat="software" data-title="Application is slow or freezing">
				<h3>Application is slow or freezing</h3>
				<div class="tags">Category: Software</div>
				<div class="steps">
					1. Check Task Manager for high CPU/RAM usage.<br>
					2. Update the app and OS to latest patches.<br>
					3. Clear app cache or reinstall if needed.
				</div>
				<button class="copy">Copy steps</button>
			</article>

			<article class="tip" data-cat="hardware" data-title="Laptop won't power on">
				<h3>Laptop won't power on</h3>
				<div class="tags">Category: Hardware</div>
				<div class="steps">
					1. Verify power adapter LED and outlet.<br>
					2. Remove battery (if removable), hold power 15s, then retry.<br>
					3. If still dead, escalate for hardware repair.
				</div>
				<button class="copy">Copy steps</button>
			</article>

			<article class="tip" data-cat="accounts" data-title="Forgot password or can't sign in">
				<h3>Forgot password / can't sign in</h3>
				<div class="tags">Category: Accounts</div>
				<div class="steps">
					1. Confirm username and caps-lock state.<br>
					2. Reset password via single-sign-on or ticket with IT.<br>
					3. Check account lockout policy if repeated failures.
				</div>
				<button class="copy">Copy steps</button>
			</article>

			<article class="tip" data-cat="network" data-title="VPN won't connect">
				<h3>VPN won't connect</h3>
				<div class="tags">Category: Network</div>
				<div class="steps">
					1. Confirm internet access is available.<br>
					2. Re-enter VPN credentials and ensure MFA completed.<br>
					3. Restart VPN client and check for known outages.
				</div>
				<button class="copy">Copy steps</button>
			</article>

			<article class="tip" data-cat="software" data-title="Email not syncing">
				<h3>Email not syncing</h3>
				<div class="tags">Category: Software</div>
				<div class="steps">
					1. Check server status and account settings.<br>
					2. Remove and re-add the account or reconfigure Mail client.<br>
					3. If mobile, ensure Background App Refresh / sync enabled.
				</div>
				<button class="copy">Copy steps</button>
			</article>
		</div>

		<footer>
			Tip: Click a category or type in search to filter tips. Want more features? Ask to add editing and persistence.
		</footer>
	</div>

	<!-- Add Tip Modal -->
	<div id="modal" style="display:none;position:fixed;inset:0;background:rgba(2,6,23,0.5);align-items:center;justify-content:center;padding:20px">
		<form id="tipForm" style="background:#fff;border-radius:10px;padding:18px;max-width:720px;width:100%;box-shadow:0 8px 24px rgba(2,6,23,0.12)">
			<h2 style="margin:0 0 8px;font-size:1.1rem">Add Troubleshooting Tip</h2>
			<div style="display:grid;grid-template-columns:1fr 200px;gap:10px;margin-bottom:8px">
				<input id="tipTitle" placeholder="Title" required style="padding:8px;border:1px solid #e5e7eb;border-radius:6px">
				<select id="tipCat" style="padding:8px;border:1px solid #e5e7eb;border-radius:6px">
					<option value="network">Network</option>
					<option value="software">Software</option>
					<option value="hardware">Hardware</option>
					<option value="accounts">Accounts</option>
				</select>
			</div>
			<textarea id="tipSteps" rows="6" placeholder="Steps (use line breaks for separate steps)" required style="width:100%;padding:8px;border:1px solid #e5e7eb;border-radius:6px"></textarea>
			<div style="display:flex;gap:8px;justify-content:flex-end;margin-top:10px">
				<button type="button" id="cancelTip" style="background:#fff;border:1px solid #e5e7eb;padding:8px 12px;border-radius:6px;cursor:pointer">Cancel</button>
				<button type="submit" style="background:#0b5fff;color:#fff;border:0;padding:8px 12px;border-radius:6px;cursor:pointer">Add Tip</button>
			</div>
		</form>
	</div>

	<!-- View Tip Modal -->
	<div id="viewModal" style="display:none;position:fixed;inset:0;background:rgba(2,6,23,0.5);align-items:center;justify-content:center;padding:20px;z-index:100">
		<div style="background:#fff;border-radius:12px;padding:24px;max-width:600px;width:100%;box-shadow:0 12px 36px rgba(2,6,23,0.15);position:relative;max-height:80vh;overflow-y:auto">
			<button id="closeViewModal" style="position:absolute;top:16px;right:16px;background:none;border:none;font-size:1.5rem;cursor:pointer;color:#6b7280">âœ•</button>
			<h2 id="viewTipTitle" style="margin:0 0 8px;font-size:1.3rem;padding-right:32px"></h2>
			<div id="viewTipCategory" style="display:inline-block;font-size:0.82rem;color:#fff;margin-bottom:16px;padding:6px 10px;border-radius:8px;background:var(--accent)"></div>
			<div id="viewTipSteps" style="font-size:0.95rem;color:#111;line-height:1.6;margin-bottom:16px;border-top:1px solid #e5e7eb;padding-top:16px"></div>
			<button id="copyFromModal" style="background:var(--accent);color:#fff;border:0;padding:10px 14px;border-radius:8px;cursor:pointer;font-weight:600">Copy steps</button>
		</div>
	</div>

	<script>
		// Theme toggle
		const themeToggle = document.getElementById('themeToggle');
		const htmlElement = document.documentElement;
		
		// Load theme preference from localStorage
		const savedTheme = localStorage.getItem('theme-mode');
		if(savedTheme === 'dark' || (!savedTheme && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
			htmlElement.classList.add('dark-mode');
			themeToggle.textContent = 'â˜€ï¸';
		}
		
		themeToggle.addEventListener('click', () => {
			htmlElement.classList.toggle('dark-mode');
			const isDark = htmlElement.classList.contains('dark-mode');
			themeToggle.textContent = isDark ? 'â˜€ï¸' : 'ðŸŒ™';
			localStorage.setItem('theme-mode', isDark ? 'dark' : 'light');
		});

		const q = document.getElementById('q');
		const cats = document.querySelectorAll('.cat');
		const tipsContainer = document.getElementById('tips');
		const addTipBtn = document.getElementById('addTipBtn');
		const modal = document.getElementById('modal');
		const tipForm = document.getElementById('tipForm');
		const cancelTip = document.getElementById('cancelTip');
		const viewModal = document.getElementById('viewModal');
		const closeViewModal = document.getElementById('closeViewModal');

		function currentTips(){ return Array.from(document.querySelectorAll('.tip')); }

		function applyFilter(){
			const term = q.value.trim().toLowerCase();
			const activeCat = document.querySelector('.cat.active')?.dataset.cat || 'all';
			currentTips().forEach(t => {
				const title = t.dataset.title.toLowerCase();
				const body = t.querySelector('.steps').innerText.toLowerCase();
				const matchesTerm = !term || title.includes(term) || body.includes(term);
				const matchesCat = activeCat === 'all' || t.dataset.cat === activeCat;
				t.style.display = (matchesTerm && matchesCat) ? '' : 'none';
			});
		}

		q.addEventListener('input', applyFilter);

		cats.forEach(c => c.addEventListener('click', e => {
			cats.forEach(x=>x.classList.remove('active'));
			e.currentTarget.classList.add('active');
			applyFilter();
		}));

		function attachCopyButtons(){
			document.querySelectorAll('.copy').forEach(btn => {
				btn.removeEventListener('click', btn.__copHandler);
				const handler = (e) => {
					e.stopPropagation();
					const button = e.currentTarget;
					const stepsDiv = button.closest('.tip').querySelector('.steps');
					const steps = stepsDiv.dataset.raw || stepsDiv.innerText;
					if (!steps) {
						alert('No steps to copy');
						return;
					}
					navigator.clipboard.writeText(steps).then(()=>{
						const prev = button.textContent;
						button.textContent = 'Copied!';
						setTimeout(()=> button.textContent = prev,1400);
					}).catch((err)=>{ 
						console.error('Clipboard error:', err);
						alert('Error: ' + (err.message || 'Copy failed')); 
					});
				};
				btn.__copHandler = handler;
				btn.addEventListener('click', handler);
			});
		}

		function attachTipClickHandlers(){
			document.querySelectorAll('.tip').forEach(tipEl => {
				tipEl.removeEventListener('click', tipEl.__clickHandler);
				const handler = (e) => {
					// Don't open modal if clicking menu or copy button
					if(e.target.closest('.menu-btn') || e.target.closest('.menu-dropdown') || e.target.closest('.copy')) return;
					
					const title = tipEl.dataset.title;
					const cat = tipEl.dataset.cat;
					const stepsDiv = tipEl.querySelector('.steps');
					const steps = stepsDiv.dataset.raw || stepsDiv.innerText;
					
					document.getElementById('viewTipTitle').innerText = title;
					document.getElementById('viewTipCategory').innerText = 'Category: ' + capitalize(cat);
					document.getElementById('viewTipSteps').innerHTML = steps.replace(/</g,'&lt;').replace(/\n/g,'<br>');
					document.getElementById('copyFromModal').dataset.steps = steps;
					
					viewModal.style.display = 'flex';
				};
				tipEl.__clickHandler = handler;
				tipEl.addEventListener('click', handler);
			});
		}

		function attachMenuButtons(){
			document.querySelectorAll('.menu-btn').forEach(btn => {
				btn.removeEventListener('click', btn.__menuHandler);
				const handler = (e) => {
					e.stopPropagation();
					const dropdown = e.currentTarget.nextElementSibling;
					const isVisible = dropdown.style.display !== 'none';
					document.querySelectorAll('.menu-dropdown').forEach(d => d.style.display = 'none');
					dropdown.style.display = isVisible ? 'none' : 'block';
				};
				btn.__menuHandler = handler;
				btn.addEventListener('click', handler);
			});

			// Close dropdown when clicking edit
			document.querySelectorAll('.menu-dropdown .edit').forEach(btn => {
				btn.removeEventListener('click', btn.__editHandler);
				const handler = (e) => {
					e.stopPropagation();
					const tip = e.currentTarget.closest('.tip');
					const title = tip.dataset.title;
					const cat = tip.dataset.cat;
					const steps = tip.querySelector('.steps').dataset.raw;
					
					document.getElementById('tipTitle').value = title;
					document.getElementById('tipCat').value = cat;
					document.getElementById('tipSteps').value = steps;
					document.getElementById('tipForm').dataset.editingTitle = title;
					document.getElementById('tipForm').dataset.editingCat = cat;
					modal.style.display = 'flex';
					document.getElementById('tipTitle').focus();
					
					e.currentTarget.closest('.menu-dropdown').style.display = 'none';
				};
				btn.__editHandler = handler;
				btn.addEventListener('click', handler);
			});

			// Close dropdown when clicking delete
			document.querySelectorAll('.menu-dropdown .delete').forEach(btn => {
				btn.removeEventListener('click', btn.__deleteHandler);
				const handler = (e) => {
					e.stopPropagation();
					const tip = e.currentTarget.closest('.tip');
					const title = tip.dataset.title;
					const cat = tip.dataset.cat;
					
					if(confirm(`Delete "${title}"?`)) {
						const raw = localStorage.getItem(STORAGE_KEY);
						const arr = JSON.parse(raw || '[]');
						const idx = arr.findIndex(t => t.title === title && t.cat === cat);
						if(idx >= 0) {
							arr.splice(idx, 1);
							localStorage.setItem(STORAGE_KEY, JSON.stringify(arr));
							tip.remove();
							applyFilter();
						}
					}
				};
				btn.__deleteHandler = handler;
				btn.addEventListener('click', handler);
			});
		}

		// Persistence: save/load to localStorage
		const STORAGE_KEY = 'it_tips_v1';

		function renderTip(t){
			const displaySteps = t.steps.replace(/</g,'&lt;').replace(/\n/g,'<br>');
			return `
				<article class="tip" data-cat="${t.cat}" data-title="${t.title}">
					<div style="display:flex;justify-content:space-between;align-items:start">
						<div style="flex:1">
							<h3>${t.title}</h3>
							<div class="tags">Category: ${capitalize(t.cat)}</div>
						</div>
						<div style="position:relative">
							<button class="menu-btn" style="background:none;border:none;color:#6b7280;cursor:pointer;font-size:1.3rem;padding:0;width:32px;height:32px;display:flex;align-items:center;justify-content:center">â‹¯</button>
							<div class="menu-dropdown" style="display:none;position:absolute;top:100%;right:0;background:#fff;border:1px solid #e5e7eb;border-radius:6px;box-shadow:0 4px 12px rgba(0,0,0,0.1);z-index:10;min-width:120px">
								<button class="edit" style="display:block;width:100%;text-align:left;background:none;border:none;padding:10px 12px;cursor:pointer;color:#374151;font-size:0.9rem;border-bottom:1px solid #f3f4f6">Edit</button>
								<button class="delete" style="display:block;width:100%;text-align:left;background:none;border:none;padding:10px 12px;cursor:pointer;color:#ef4444;font-size:0.9rem">Delete</button>
							</div>
						</div>
					</div>
					<div class="steps" data-raw="${t.steps.replace(/"/g,'&quot;')}">${displaySteps}</div>
					<button class="copy">Copy steps</button>
				</article>
			`;
		}

		function capitalize(s){ return s.charAt(0).toUpperCase()+s.slice(1); }

		function loadStoredTips(){
			const raw = localStorage.getItem(STORAGE_KEY);
			if(raw){
				try{
					const arr = JSON.parse(raw);
					tipsContainer.innerHTML = arr.map(renderTip).join('');
				}catch(e){ console.error('Failed to parse stored tips',e); }
			} else {
				// gather existing DOM tips and seed storage
				const existing = currentTips().map(t=>({
					title: t.dataset.title || t.querySelector('h3')?.innerText || 'Untitled',
					cat: t.dataset.cat || 'software',
					steps: t.querySelector('.steps')?.innerText || ''
				}));
				if(existing.length) localStorage.setItem(STORAGE_KEY, JSON.stringify(existing));
			}
			attachCopyButtons();
			attachMenuButtons();
			attachTipClickHandlers();
		}

		function saveTipToStorage(obj){
			const raw = localStorage.getItem(STORAGE_KEY);
			const arr = raw ? JSON.parse(raw) : [];
			arr.unshift(obj);
			localStorage.setItem(STORAGE_KEY, JSON.stringify(arr));
		}

		// Modal handlers
		addTipBtn.addEventListener('click', ()=>{ modal.style.display='flex'; document.getElementById('tipTitle').focus(); });
		cancelTip.addEventListener('click', ()=>{ modal.style.display='none'; tipForm.reset(); });
		
		closeViewModal.addEventListener('click', ()=>{ viewModal.style.display='none'; });
		viewModal.addEventListener('click', (e) => {
			if(e.target === viewModal) viewModal.style.display='none';
		});

		const copyFromModalBtn = document.getElementById('copyFromModal');
		if(copyFromModalBtn) {
			copyFromModalBtn.addEventListener('click', (e) => {
				const btn = e.currentTarget;
				const steps = btn.dataset.steps;
				if(!steps) {
					alert('No steps to copy');
					return;
				}
				navigator.clipboard.writeText(steps).then(()=>{
					const prev = btn.textContent;
					btn.textContent = 'Copied!';
					setTimeout(()=> btn.textContent = prev,1400);
				}).catch((err)=>{
					console.error('Clipboard error:', err);
					alert('Error: ' + (err.message || 'Copy failed'));
				});
			});
		}

		tipForm.addEventListener('submit', e=>{
			e.preventDefault();
			const title = document.getElementById('tipTitle').value.trim();
			const cat = document.getElementById('tipCat').value;
			const steps = document.getElementById('tipSteps').value.trim();
			if(!title || !steps) return;
			
			const editingTitle = tipForm.dataset.editingTitle;
			const editingCat = tipForm.dataset.editingCat;
			
			if(editingTitle) {
				// Update existing tip
				const raw = localStorage.getItem(STORAGE_KEY);
				const arr = JSON.parse(raw || '[]');
				const idx = arr.findIndex(t => t.title === editingTitle && t.cat === editingCat);
				if(idx >= 0) {
					arr[idx] = {title, cat, steps};
					localStorage.setItem(STORAGE_KEY, JSON.stringify(arr));
					loadStoredTips();
					applyFilter();
				}
				delete tipForm.dataset.editingTitle;
				delete tipForm.dataset.editingCat;
			} else {
				// Add new tip
				const tipObj = {title, cat, steps};
				saveTipToStorage(tipObj);
				tipsContainer.insertAdjacentHTML('afterbegin', renderTip(tipObj));
				attachCopyButtons();
				attachMenuButtons();
				attachTipClickHandlers();
				applyFilter();
			}
			tipForm.reset();
			modal.style.display='none';
		});

		// Initialize
		document.addEventListener('DOMContentLoaded', ()=>{
			loadStoredTips();
			applyFilter();
		});
	</script>
</body>
</html>
